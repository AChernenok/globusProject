import{an as y,j as e,fm as A,fo as c,fp as d,fi as o,id as x,ie as O,ig as j,ih as T,ii as u,dk as $,ij as F,fg as H,ao as z,s as B,ik as W,r as b,aQ as g,P as _,fj as G,O as P,fk as U,il as q,N as Q,im as V,io as Y,cF as J}from"./strapi-D_yz_Lh-.js";const K=({sort:s="",pageSize:t=10,onChange:a})=>{const{formatMessage:n}=y();return e.jsx(A,{background:"neutral0",hasRadius:!0,shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(c.Root,{gap:4,children:[e.jsx(c.Item,{s:12,col:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.entries.note"),defaultMessage:"Number of assets displayed by default in the Media Library"}),name:"pageSize",children:[e.jsx(d.Label,{children:n({id:o("config.entries.title"),defaultMessage:"Entries per page"})}),e.jsx(x,{onChange:i=>a({target:{name:"pageSize",value:i}}),value:t,children:O.map(i=>e.jsx(j,{value:i,children:i},i))}),e.jsx(d.Hint,{})]})}),e.jsx(c.Item,{s:12,col:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.note"),defaultMessage:"Note: You can override this value in the media library."}),name:"sort",children:[e.jsx(d.Label,{children:n({id:o("config.sort.title"),defaultMessage:"Default sort order"})}),e.jsx(x,{onChange:i=>a({target:{name:"sort",value:i}}),value:s,"test-sort":s,"data-testid":"sort-select",children:T.map(i=>e.jsx(j,{"data-testid":`sort-option-${i.value}`,value:i.value,children:n({id:o(i.key),defaultMessage:`${i.value}`})},i.key))}),e.jsx(d.Hint,{})]})})]})})},D=`${u}/ON_CHANGE`,v=`${u}/SET_LOADED`,X=({name:s,value:t})=>({type:D,keys:s,value:t}),Z=()=>({type:v}),f={initialData:{},modifiedData:{}},k=s=>({...f,initialData:s,modifiedData:s}),ee=(s=f,t={type:""})=>$(s,a=>{switch(t.type){case D:{"keys"in t&&"value"in t&&t.keys&&H(a,["modifiedData",...t.keys.split(".")],t.value);break}case v:{const n=k(F(a,["modifiedData"],{}));a.initialData=n.initialData,a.modifiedData=n.modifiedData;break}default:return a}}),ae=({config:s})=>{const{trackUsage:t}=z(),{formatMessage:a}=y(),{toggleNotification:n}=B(),{mutateConfig:i}=W(),{isLoading:S}=i,[C,h]=b.useState(!1),m=()=>h(r=>!r),[M,w]=b.useReducer(ee,f,()=>k(s)),p=w,{initialData:L,modifiedData:l}=M,E=r=>{r.preventDefault(),m()},R=async()=>{t("willEditMediaLibraryConfig"),await i.mutateAsync(l),h(!1),p(Z()),n({type:"success",message:a({id:"notification.form.success.fields",defaultMessage:"Changes saved"})})},N=({target:{name:r,value:I}})=>{p(X({name:r,value:I}))};return e.jsx(g.Root,{children:e.jsx(_.Main,{"aria-busy":S,children:e.jsxs("form",{onSubmit:E,children:[e.jsx(g.Header,{navigationAction:e.jsx(q,{tag:Q,startIcon:e.jsx(V,{}),to:`/plugins/${u}`,id:"go-back",children:a({id:o("config.back"),defaultMessage:"Back"})}),primaryAction:e.jsx(G,{size:"S",startIcon:e.jsx(U,{}),disabled:P(l,L),type:"submit",children:a({id:"global.save",defaultMessage:"Save"})}),subtitle:a({id:o("config.subtitle"),defaultMessage:"Define the view settings of the media library."}),title:a({id:o("config.title"),defaultMessage:"Configure the view - Media Library"})}),e.jsx(g.Content,{children:e.jsx(K,{"data-testid":"settings",pageSize:l.pageSize||"",sort:l.sort||"",onChange:N})}),"x",e.jsx(Y.Root,{open:C,onOpenChange:m,children:e.jsx(J,{onConfirm:R,variant:"default",children:a({id:o("config.popUpWarning.warning.updateAllSettings"),defaultMessage:"This will modify all your settings"})})})]})})})};export{ae as ConfigureTheView};
